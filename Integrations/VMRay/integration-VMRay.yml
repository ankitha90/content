category: Forensics & Malware Analysis
commonfields:
  id: vmray2
  version: -1
configuration:
- defaultvalue: https://cloud.vmray.com/
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- display: API-Key
  name: api_key
  required: false
  type: 4
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- display: Trust any certificate (unsecure)
  name: insecure
  required: false
  type: 8
description: Ransomware analysis sandboxing
display: VMRay2
name: vmray2
script:
  commands:
  - arguments:
    - default: false
      description: Entry id  of file to submit
      isArray: false
      name: entry_id
      required: true
      secret: false
    - default: false
      description: Password of the document
      isArray: false
      name: document_password
      required: false
      secret: false
    - default: false
      description: password of an archive
      isArray: false
      name: archive_password
      required: false
      secret: false
    - default: false
      description: Force type of file
      isArray: false
      name: sample_type
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Make the file shareable
      isArray: false
      name: shareable
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Analyze no matter if analyses already exist
      isArray: false
      name: reanalyze
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      description: Maximum jobs to be created (number)
      isArray: false
      name: max_jobs
      required: false
      secret: false
    - default: false
      description: Tags to add to sample (comma seperated)
      isArray: false
      name: tags
      required: false
      secret: false
    deprecated: false
    description: Submit sample to VMRay
    execution: false
    name: vmray-upload-sample
    outputs:
    - contextPath: VMRay.Job.JobID
      description: ID of a new job
      type: Number
    - contextPath: VMRay.Job.Created
      description: Timestamp of created job
      type: Date
    - contextPath: VMRay.Job.SampleID
      description: ID of sample
      type: Number
    - contextPath: VMRay.Job.VMName
      description: Name of virtual machine
      type: String
    - contextPath: VMRay.Job.VMID
      description: ID of virtual machine
      type: Number
    - contextPath: VMRay.Sample.SampleID
      description: ID of sample
      type: Number
    - contextPath: VMRay.Sample.Created
      description: Timestamp of created sample
      type: Date
    - contextPath: VMRay.Submission.SubmissionID
      description: Submission ID
      type: Number
  - arguments:
    - default: false
      description: Analysis sample ID
      isArray: false
      name: sample_id
      required: true
      secret: false
    - default: false
      description: Limits results (number)
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Get all analysis details about a specific sample.
    execution: false
    name: vmray-get-analysis-by-sample
    outputs:
    - contextPath: VMRay.Analysis.AnalysisID
      description: ID of analysis
      type: Number
    - contextPath: VMRay.Analysis.SampleID
      description: Sample ID in analysis
      type: Number
    - contextPath: VMRay.Analysis.Severity
      description: Severity of sample (Malicious, Suspicious, Good, Blacklisted, Whitelested,
        Unknown)
      type: String
    - contextPath: VMRay.Analysis.JobCreated
      description: Analysis job started
      type: Date
    - contextPath: VMRay.Analysis.MD5
      description: MD5 of sample
      type: String
    - contextPath: VMRay.Analysis.SHA1
      description: SHA1 of sample
      type: String
    - contextPath: VMRay.Analysis.SHA256
      description: SHA256 of sample
      type: String
    - contextPath: VMRay.Analysis.SSDeep
      description: SSDeep of sample
      type: String
  - arguments:
    - default: false
      description: Job sample id
      isArray: false
      name: sample_id
      required: true
      secret: false
    deprecated: false
    description: Get all jobs details about a specific sample.
    execution: false
    name: vmray-get-job-sample
    outputs:
    - contextPath: VMRay.Job.JobID
      description: ID of job
      type: Number
    - contextPath: VMRay.Job.SampleID
      description: Sample ID of job
      type: Number
    - contextPath: VMRay.Job.SubmissionID
      description: ID of submission
      type: Number
    - contextPath: VMRay.Job.MD5
      description: MD5 of sample in job
      type: String
    - contextPath: VMRay.Job.SHA1
      description: SHA1 of sample in job
      type: String
    - contextPath: VMRay.Job.SHA256
      description: SHA256 of sample in job
      type: String
    - contextPath: VMRay.Job.SSDeep
      description: SSDeep of sample in job
      type: String
    - contextPath: VMRay.Job.JobVMName
      description: Name of virtual machine
      type: String
    - contextPath: VMRay.Job.JobVMID
      description: ID of virtual machine
      type: Number
  - arguments:
    - default: false
      description: ID of submission (can be aquired from vmray-upload-sample)
      isArray: false
      name: submission_id
      required: true
      secret: false
    deprecated: false
    description: Gets a submission result
    execution: false
    name: vmray-get-submission
    outputs:
    - contextPath: VMRay.Submission.IsFinished
      description: Status of submission (true or false)
      type: Boolean
    - contextPath: VMRay.Submission.HasErrors
      description: If there are any errors in the submission
      type: Boolean
    - contextPath: VMRay.Submission.SubmissionID
      description: ID of of sample in submission
      type: Number
    - contextPath: VMRay.Submission.MD5
      description: MD5 of of sample in submission
      type: String
    - contextPath: VMRay.Submission.SHA1
      description: SHA1 of of sample in submission
      type: String
    - contextPath: VMRay.Submission.SHA256
      description: SHA256 of of sample in submission
      type: String
    - contextPath: VMRay.Submission.SSDeep
      description: SSDeep of of sample in submission
      type: String
    - contextPath: VMRay.Submission.Severity
      description: Severity of sample in submission (Malicious, Suspicious, Good,
        Blacklisted, Whitelested, Unknown)
      type: String
    - contextPath: VMRay.Submission.SampleID
      description: ID of sample in submission
      type: Number
  - arguments:
    - default: false
      description: 'id of sample '
      isArray: false
      name: sample_id
      required: true
      secret: false
    deprecated: false
    description: get sample by sample id
    execution: false
    name: vmray-get-sample
    outputs:
    - contextPath: VMRay.Sample.SampleID
      description: ID of sample
      type: Number
    - contextPath: VMRay.Sample.FileName
      description: File name of sample
      type: String
    - contextPath: VMRay.Sample.MD5
      description: MD5 of sample
      type: String
    - contextPath: VMRay.Sample.SHA1
      description: SHA1 of sample
      type: String
    - contextPath: VMRay.Sample.SHA256
      description: SHA256 of sample
      type: String
    - contextPath: VMRay.Sample.SSDeep
      description: SSDeep of sample
      type: String
    - contextPath: VMRay.Sample.Severity
      description: Severity of sample in submission (Malicious, Suspicious, Good,
        Blacklisted, Whitelested, Unknown)
      type: String
    - contextPath: VMRay.Sample.Type
      description: File type
      type: String
    - contextPath: VMRay.Sample.Created
      description: timestamp of created sample
      type: Date
    - contextPath: VMRay.Sample.Classifications
      description: Classifications of sample
      type: String
  - arguments:
    - default: false
      description: ID of sample (can get from VMRay.Sample.ID)
      isArray: false
      name: sample_id
      required: true
      secret: false
    deprecated: false
    description: Get threat indicators (VTI)
    execution: false
    name: vmray-get-threat-indicators
    outputs:
    - contextPath: VMRay.ThreatIndicator.AnalysisID
      description: List of connected analyses ids
      type: Number
    - contextPath: VMRay.ThreatIndicator.Category
      description: Category of threat indicators
      type: String
    - contextPath: VMRay.ThreatIndicator.Classification
      description: Classifications of threat indicators
      type: String
    - contextPath: VMRay.ThreatIndicator.ID
      description: ID of threat indicator
      type: Number
    - contextPath: VMRay.ThreatIndicator.Operation
      description: Operation the indicators caused
      type: String
  - arguments:
    - default: false
      description: ID of submission to add tag to
      isArray: false
      name: submission_id
      required: false
      secret: false
    - default: false
      description: ID of analysis to delete tag from
      isArray: false
      name: analysis_id
      required: false
      secret: false
    - default: false
      description: Tag to add
      isArray: false
      name: tag
      required: false
      secret: false
    deprecated: false
    description: Adds a tag to analysis and/or submission
    execution: false
    name: vmray-add-tag
  - arguments:
    - default: false
      description: ID of analysis to delete tag from
      isArray: false
      name: analysis_id
      required: false
      secret: false
    - default: false
      description: ID of submission to delete tag from
      isArray: false
      name: submission_id
      required: false
      secret: false
    - default: false
      description: Tag to delete
      isArray: false
      name: tag
      required: false
      secret: false
    deprecated: false
    description: Delete tags from analysis and/or submission
    execution: false
    name: vmray-delete-tag
  - arguments:
    - default: false
      description: if of sample
      isArray: false
      name: sample_id
      required: true
      secret: false
    deprecated: false
    description: getting iocs of given sample
    execution: false
    name: vmray-get-iocs
    outputs:
    - contextPath: VMRay.Sample.IOC.URL.AnalysisID
      description: IDs of other analyses conatining given URL
      type: Number
    - contextPath: VMRay.Sample.IOC.URL.URL
      description: URL
      type: String
    - contextPath: VMRay.Sample.IOC.URL.Operation
      description: Operation of given url
      type: String
    - contextPath: VMRay.Sample.IOC.URL.ID
      description: ID of URL
      type: Number
    - contextPath: VMRay.Sample.IOC.URL.Type
      description: Type of url
      type: String
    - contextPath: VMRay.Sample.IOC.Domain.AnalysisID
      description: IDs of other analyses conatining given Domain
      type: Number
    - contextPath: VMRay.Sample.IOC.Domain.Domain
      description: Domain
      type: String
    - contextPath: VMRay.Sample.IOC.Domain.ID
      description: ID of domain
      type: Number
    - contextPath: VMRay.Sample.IOC.Domain.Type
      description: Type of domain
      type: String
    - contextPath: VMRay.Sample.IOC.IP.AnalysisID
      description: IDs of other analyses conatining given IP
      type: Number
    - contextPath: VMRay.Sample.IOC.IP.IP
      description: IP
      type: String
    - contextPath: VMRay.Sample.IOC.IP.Operation
      description: Operation of given IP
      type: String
    - contextPath: VMRay.Sample.IOC.IP.ID
      description: ID of IP
      type: Number
    - contextPath: VMRay.Sample.IOC.IP.Type
      description: Type of IP
      type: String
    - contextPath: VMRay.Sample.IOC.Mutex.AnalysisID
      description: IDs of other analyses conatining given IP
      type: Number
    - contextPath: VMRay.Sample.IOC.Mutex.Name
      description: Name of mutex
      type: String
    - contextPath: VMRay.Sample.IOC.Mutex.Operation
      description: Operation of given mutex
      type: String
    - contextPath: VMRay.Sample.IOC.Mutex.ID
      description: ID of mutex
      type: Number
    - contextPath: VMRay.Sample.IOC.Mutex.Type
      description: Type of mutex
      type: String
  dockerimage: demisto/python
  isfetch: false
  runonce: false
  script: ''
  type: python
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAJkklEQVR42u1aaWxU1xWepilKmpYAsWdsMMYbM/PmOd7GxrHjtChSFCpVUaUmP6JGVX+VQJRECWuhLYNTRWwxBLDHs73nGeMltmkIJoG0KRAwYBq3YHv2xTYYHJyiVklaNSpNbr8zZjZmN+M/FVc68pt3zz3nfOc797773rUkUVOInnf5jquME90JhTfaWOH+T1i2zs6krbaUhHQL9g8x3mBLbr9jkilFd59ktq3Y4HySs4z9l2vzxHWiNHtZVdNZVqU5SgGmDqTVzio1/axqzxmyER8IfKssvlslguOHkrtpCsF5JD4rcGJysLrf/J41bO5kRU0XkGlHchDQKdw7SGMw9jBTGe1kK6YP8i0XXIcld9uKTM5qzuz7CpmJyUblW2dYw6ZOBNXF1NveY7IUGakCGxhDY8HK6ZiswCfE+1WJ2VMpyURTmFwWvnMymnLMjbpfH2aPI6DHf9XtD6z4rXMsKwErYAPMnSddGgPpgo1ezBUruzNZ5FMhuAVJptpyg5uDk38iO5FzY/dpyigFFARS89sjTKa1xgVCfdVgLggEQjbUu04yZZh9+CL5QmFyKiSZbErRdRAZCrJBGazf2otAQgGRPIG6X777bExW6F7JngGACIAPCmz1sFLdKNkOZ2Mf+c4wEEcBnPydAxOUOfXOk+FsRLCyApM/p2UkBhujYOzdcDYiWKne8ZHfNuYkAbpZpLPlS+aiKQXXm6qu68jcCGUwPJAoVhS7Po5gBddg6gz1xR1XvwWstA4zVdc1phDdjZK5agWiLQcZu16zK8hGHOlitVgEcsNYIYaIqQb0xRtHJVez8080/yaLtV6pZC4bv3/wjQbN0YDzhKwod54iJkjA0Gm6l3yc5j1WtveCRjKnrYd9O/fApQ9rtx8L1HlCeWxrH8ttHiZmwFAf7iUeQzZrG4+x3IOXj0s07L45wyHT257JNnrY8j1nqQxSYkW14yTjdp5OSZ90yHa2yftNlnb0x3NTUj22edla65+lAELPgpptR5Ky0gCp3NTFqjbhOr5e9DMIPqSt1kGJxjYv40CkWtvPZCZvcAXCEzyl8ip8RWTFr4pJgETvCmSUsFbr85ktqd3DD8G4VWZ0hz0XrLS3ogDis7HhEMt5ychyIeqNHfHABPdpsBm0P+PLPrJYN/TdDLIxukYm+KJ3sE0XKIiEbBAQkiKwkoiNwhg7Z79P7cjqjIBYIF5aAKM+qcEVexe7vT8KTMMWsLE+wEZIiKGGaBBkI/a+bMand6HO93AG2LBulAljcXeyBfsuJmAjBIKuC14RYj48YSPue8xt3+vvDsS+URmMTEkNzoRvehWN79PSGWSjIoqNEJhy9EEnuNxWYixsxLXvrwSd/bpMOzz7J3221vY7mTiW9N172dufRGQZmY8LZNnLAqsP6WJs8nd9fwxa++z2Xgux85TqHDelekdKHxLK3zjOfoB6L49kIxrMWiN7dF076dKY1D5Y6Kki7DcXNXuXzoaNt0NzIzmQpfgiUkcZjmIjmpX8l02sdnM3y8eYpEBCrKAEbem9n2S1OBWoyy/BSOpfRsBcSeMHLHeNngJOLNAp0LyPMWnYRyzQ/yKrZViRBhtWMcBGqpJrcLAy0cGWvGpmuWsNcUGgDzptjDchy+kAgSAmsDIqpFpSlajJf4ORlB1gDFPgzbGuDy9EeJ/IeVEXFwj1kc5j0C0S3RibOhCKiWLL1tsqUnlu9OGJmjoIyGK9nVV3T7DanqtMfcjD8l5rj80K7uW93s6qD3n9upWd4ywnecKinvaomN7EbOhsDUB8K102OAsFdoWteOcKq0WmlXs+jskK3eOazpIO6frHlMyOlVvZzZcbYqPQaO7DDveETPCmxcYSzI2abgJxW5Dp6g4fW7quI4KVHEzw/A3YqneNh3QhVV0T6bOCXTgq5wTFHIUDQa2SGtzfQDEtNvBdNsAGJMSKau85BK+LAFJ64CKr7b0WqYux8jZPeqxAEOvX2c22VZEodEPfwRZ6AO8AabGRR2xQQFFylTIPBrrxANT7QRRs6aO+mKLG/MrVp8kKYgUrAxR7iI0W23PUkS4bfHs4G9Gs8AcGCYS/xMpa/wo2JmPrwobCnDYrBAYJdT7rB5HXdP5BeoHBakCTKCXJhuQLbiqTRIL5MsnyN/eyom1HAex6Qt0a6C4xush+ykIxU+yEQZKlta3G7vZT2uWmKsjcFN/unUY2p2vemYgrK3qvTZc2D02X6YenASqxbs+VabnFe4NspxMLdsefEgaJDB/C5jfZFj3cMrIwVclvubJQrnNlyTuTi7p/KkvdOZWVir7SfO0Rsp+OUOyEQXKv3Wv32r32/9EUZmeZQvA8G3Ufp7y86F1VIY4v4MwTazmjtzSiX3Suwtnfz/N6Jh9Umhw/xenTWpXZu1opelbG+sK+8hS7Xym4n1eJrifod8khz3yV4HyB/obrcaLrJ0qzT57+6ZTZU4ezvH8g8MUR90X3KZyJb5KLLiXfPcU4/A4EWGoYk8Hh59D5jICoTN4fceYxA47RzNhceqFreg5HExH2BEc9wDKcUToKxPEH+B42b8ZH6PwQ108B7CRntC9LGwgFh4D/wgnONcFsWyYKlW3uSQLHi+4KTnDbcRx3GcE8Tf34vRVyHo6tfM9n3ws3Jze5ytH3ZWmbp/iOxLTeFr+d4Cmy4Pqbyojzdc2p+2FvGP2/mHV5wfFGGDkTlpkNyMwJuuZFXw2cDeI3lc3xApSaSvQMUJmAFdedQHBkp4a9G3yzLSdwr2S/Zz6S5SZ2MW43gu0I89UIOx8hUdtx/aGEsW/Nfp5YnIUwckOpd8hv1+lFleB5IQCE2KBahs4FlE4f/u6Sm6zlCMgXAFKML4TKNs+bOA0e4gTPa+H2ecxBlNQAXavaPDwSM6E0Ox6h32WW4Ydg7xLk84yctcP4H2eYsS9HgGO80bYoAIQop2sqP84y/jVv8eXTYhAOhA6IkG0BSRinORDJkrtXZRnzgFE9/LTh+j/EaKCf5iKxIslEoxUImT9H2ebwrxx0LxzIStQwgv8+Z7A/RfexUtWFAwmAQaB/gP7hwMJA8wyBTuC/j7aqBPd6pcm1DkB6oPdB2D8pvO4vq0w0ohrGxuH0XwrB+WQwOOPYCpTKKH/H8ZhSP1qPTI9HTXbsbmHDBdkxkyDXS/4VDy1k01tCpSwX3EUzjLnWZQwINTBxEHKxDktqKFu+R1EG/epf4lUzrJVgpUF2Ty7un4o6aULmaxEYo4Tg7zHIhggFTGiaFwrR/WK6QP4Hw4jcThaKLbQAAAAASUVORK5CYII=
